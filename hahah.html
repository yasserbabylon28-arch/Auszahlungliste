<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Auszahlungs-Tracker</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #00f08c 0%, #764ba2 100%);
            padding: 20px;
            min-height: 100vh;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 60px rgba(0, 255, 157, 0.3);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #00f08c 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .tabs {
            display: flex;
            background: #f5f5f5;
            border-bottom: 2px solid #ddd;
            overflow-x: auto;
        }

        .tab {
            padding: 15px 30px;
            cursor: pointer;
            background: #0081fa6b;
            border: none;
            font-size: 16px;
            font-weight: 600;
            transition: all 0.3s;
            white-space: nowrap;
        }

        .tab:hover {
            background: #e0e0e0;
        }

        .tab.active {
            background: white;
            color: #00eb6a;
            border-bottom: 3px solid #05b95f;
        }

        .content {
            padding: 30px;
        }

        .section {
            display: none;
        }

        .section.active {
            display: block;
        }

        .info-box {
            background: #f8f9fa;
            border-left: 4px solid #667eea;
            padding: 15px;
            margin-bottom: 20px;
            border-radius: 5px;
        }

        .info-box h3 {
            color: #667eea;
            margin-bottom: 10px;
        }

        .info-box ul {
            list-style: none;
            padding-left: 10px;
        }

        .info-box li {
            padding: 5px 0;
            color: #555;
        }

        .info-box li:before {
            content: "ðŸ’° ";
            margin-right: 5px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        thead {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        th {
            padding: 15px;
            text-align: left;
            font-weight: 600;
        }

        td {
            padding: 12px 15px;
            border-bottom: 1px solid #ddd;
        }

        tbody tr:hover {
            background: #f5f5f5;
        }

        .input-group {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        input, select {
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 5px;
            font-size: 14px;
            transition: border 0.3s;
        }

        input:focus, select:focus {
            outline: none;
            border-color: #667eea;
        }

        button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            transition: transform 0.2s;
        }

        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        .delete-btn {
            background: #dc3545;
            padding: 8px 15px;
            font-size: 14px;
        }

        .delete-btn:hover {
            background: #c82333;
        }

        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
        }

        .stat-card h3 {
            font-size: 2em;
            margin-bottom: 5px;
        }

        .stat-card p {
            opacity: 0.9;
        }

        .export-btn {
            background: #28a745;
            margin-left: 10px;
        }

        .export-btn:hover {
            background: #218838;
        }

        .reset-btn {
            background: #dc3545;
            margin-left: 10px;
        }

        .reset-btn:hover {
            background: #c82333;
        }

        .loading {
            display: inline-block;
            margin-left: 10px;
            color: #667eea;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ðŸŽ® Auszahlungs-Tracker</h1>
            <p>Verwalte alle Auszahlungen und Belohnungen</p>
            <p style="font-size: 0.9em; opacity: 0.8;">âœ… Daten werden automatisch gespeichert</p>
        </div>

        <div class="tabs">
            <button class="tab active" onclick="switchTab('fort-zancudo')">Fort Zancudo</button>
            <button class="tab" onclick="switchTab('spray-logs')">Spray-Logs</button>
            <button class="tab" onclick="switchTab('cland')">Cland</button>
            <button class="tab" onclick="switchTab('ammu')">Ammu</button>
            <button class="tab" onclick="switchTab('invites')">Invite-Auszahlung</button>
        </div>

        <div class="content">
            <!-- Fort Zancudo Section -->
            <div id="fort-zancudo" class="section active">
                <div class="info-box">
                    <h3>ðŸ“‹ Regelung</h3>
                    <ul>
                        <li>Giveaway bei Gewinn</li>
                    </ul>
                </div>

                <div class="input-group">
                    <input type="text" id="fz-name" placeholder="Spielername">
                    <input type="date" id="fz-date">
                    <input type="text" id="fz-prize" placeholder="Gewinn">
                    <button onclick="addEntry('fort-zancudo')">Eintrag hinzufÃ¼gen</button>
                    <button class="export-btn" onclick="exportData('fort-zancudo')">Exportieren (CSV)</button>
                    <button class="reset-btn" onclick="resetData('fort-zancudo')">Alle Daten lÃ¶schen</button>
                </div>

                <table id="fz-table">
                    <thead>
                        <tr>
                            <th>Datum</th>
                            <th>Spielername</th>
                            <th>Gewinn</th>
                            <th>Aktion</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>

            <!-- Spray-Logs Section -->
            <div id="spray-logs" class="section">
                <div class="info-box">
                    <h3>ðŸ“‹ Belohnungen</h3>
                    <ul>
                        <li>Top 1 - 100k</li>
                        <li>Top 2 - 50k</li>
                        <li>Top 3 - 25k</li>
                    </ul>
                </div>

                <div class="input-group">
                    <input type="text" id="sl-name" placeholder="Spielername">
                    <input type="date" id="sl-date">
                    <select id="sl-place">
                        <option value="">Platzierung wÃ¤hlen</option>
                        <option value="1">Top 1 (100k)</option>
                        <option value="2">Top 2 (50k)</option>
                        <option value="3">Top 3 (25k)</option>
                    </select>
                    <button onclick="addEntry('spray-logs')">Eintrag hinzufÃ¼gen</button>
                    <button class="export-btn" onclick="exportData('spray-logs')">Exportieren (CSV)</button>
                    <button class="reset-btn" onclick="resetData('spray-logs')">Alle Daten lÃ¶schen</button>
                </div>

                <div class="stats">
                    <div class="stat-card">
                        <h3 id="sl-total">0k</h3>
                        <p>Gesamt ausgezahlt</p>
                    </div>
                </div>

                <table id="sl-table">
                    <thead>
                        <tr>
                            <th>Datum</th>
                            <th>Spielername</th>
                            <th>Platzierung</th>
                            <th>Auszahlung</th>
                            <th>Aktion</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>

            <!-- Cland Section -->
            <div id="cland" class="section">
                <div class="info-box">
                    <h3>ðŸ“‹ Regelung</h3>
                    <ul>
                        <li>25k pro Drop</li>
                        <li>5k pro Kill</li>
                    </ul>
                </div>

                <div class="input-group">
                    <input type="text" id="cl-name" placeholder="Spielername">
                    <input type="date" id="cl-date">
                    <input type="number" id="cl-drops" placeholder="Anzahl Drops" min="0">
                    <input type="number" id="cl-kills" placeholder="Anzahl Kills" min="0">
                    <button onclick="addEntry('cland')">Eintrag hinzufÃ¼gen</button>
                    <button class="export-btn" onclick="exportData('cland')">Exportieren (CSV)</button>
                    <button class="reset-btn" onclick="resetData('cland')">Alle Daten lÃ¶schen</button>
                </div>

                <div class="stats">
                    <div class="stat-card">
                        <h3 id="cl-total">0k</h3>
                        <p>Gesamt ausgezahlt</p>
                    </div>
                </div>

                <table id="cl-table">
                    <thead>
                        <tr>
                            <th>Datum</th>
                            <th>Spielername</th>
                            <th>Drops</th>
                            <th>Kills</th>
                            <th>Auszahlung</th>
                            <th>Aktion</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>

            <!-- Ammu Section -->
            <div id="ammu" class="section">
                <div class="info-box">
                    <h3>ðŸ“‹ Regelung</h3>
                    <ul>
                        <li>10k fÃ¼r das Anfahren</li>
                    </ul>
                </div>

                <div class="input-group">
                    <input type="text" id="am-name" placeholder="Spielername">
                    <input type="date" id="am-date">
                    <input type="number" id="am-count" placeholder="Anzahl Anfahrten" min="0">
                    <button onclick="addEntry('ammu')">Eintrag hinzufÃ¼gen</button>
                    <button class="export-btn" onclick="exportData('ammu')">Exportieren (CSV)</button>
                    <button class="reset-btn" onclick="resetData('ammu')">Alle Daten lÃ¶schen</button>
                </div>

                <div class="stats">
                    <div class="stat-card">
                        <h3 id="am-total">0k</h3>
                        <p>Gesamt ausgezahlt</p>
                    </div>
                </div>

                <table id="am-table">
                    <thead>
                        <tr>
                            <th>Datum</th>
                            <th>Spielername</th>
                            <th>Anfahrten</th>
                            <th>Auszahlung</th>
                            <th>Aktion</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>

            <!-- Invites Section -->
            <div id="invites" class="section">
                <div class="info-box">
                    <h3>ðŸ“‹ Belohnungen</h3>
                    <ul>
                        <li>Top 1 - Heavy [min. 20 Invites]</li>
                        <li>Top 2 - 250k [min. 15 Invites]</li>
                        <li>Top 3 - 150k [min. 10 Invites]</li>
                    </ul>
                </div>

                <div class="input-group">
                    <input type="text" id="inv-name" placeholder="Spielername">
                    <input type="date" id="inv-date">
                    <input type="number" id="inv-count" placeholder="Anzahl Invites" min="0">
                    <select id="inv-place">
                        <option value="">Platzierung wÃ¤hlen</option>
                        <option value="1">Top 1 (Heavy)</option>
                        <option value="2">Top 2 (250k)</option>
                        <option value="3">Top 3 (150k)</option>
                    </select>
                    <button onclick="addEntry('invites')">Eintrag hinzufÃ¼gen</button>
                    <button class="export-btn" onclick="exportData('invites')">Exportieren (CSV)</button>
                    <button class="reset-btn" onclick="resetData('invites')">Alle Daten lÃ¶schen</button>
                </div>

                <table id="inv-table">
                    <thead>
                        <tr>
                            <th>Datum</th>
                            <th>Spielername</th>
                            <th>Invites</th>
                            <th>Platzierung</th>
                            <th>Belohnung</th>
                            <th>Aktion</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>
        </div>
    </div>

    <script>
        const data = {
            'fort-zancudo': [],
            'spray-logs': [],
            'cland': [],
            'ammu': [],
            'invites': []
        };

        // Daten beim Start laden
        async function loadAllData() {
            for (const type of Object.keys(data)) {
                await loadData(type);
            }
        }

        // Daten aus Storage laden
        async function loadData(type) {
            try {
                const result = await window.storage.get(`tracker:${type}`, false);
                if (result && result.value) {
                    data[type] = JSON.parse(result.value);
                    updateTable(type);
                    updateStats(type);
                }
            } catch (error) {
                console.log(`Keine gespeicherten Daten fÃ¼r ${type}`);
            }
        }

        // Daten in Storage speichern
        async function saveData(type) {
            try {
                await window.storage.set(`tracker:${type}`, JSON.stringify(data[type]), false);
            } catch (error) {
                console.error('Fehler beim Speichern:', error);
                alert('Fehler beim Speichern der Daten!');
            }
        }

        function switchTab(tabName) {
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
            
            event.target.classList.add('active');
            document.getElementById(tabName).classList.add('active');
        }

        async function addEntry(type) {
            let entry = {};

            if (type === 'fort-zancudo') {
                entry = {
                    date: document.getElementById('fz-date').value,
                    name: document.getElementById('fz-name').value,
                    prize: document.getElementById('fz-prize').value
                };
                if (!entry.date || !entry.name || !entry.prize) return alert('Bitte alle Felder ausfÃ¼llen!');
            } 
            else if (type === 'spray-logs') {
                const place = document.getElementById('sl-place').value;
                const prizes = {'1': '100k', '2': '50k', '3': '25k'};
                entry = {
                    date: document.getElementById('sl-date').value,
                    name: document.getElementById('sl-name').value,
                    place: `Top ${place}`,
                    payout: prizes[place]
                };
                if (!entry.date || !entry.name || !place) return alert('Bitte alle Felder ausfÃ¼llen!');
            }
            else if (type === 'cland') {
                const drops = parseInt(document.getElementById('cl-drops').value) || 0;
                const kills = parseInt(document.getElementById('cl-kills').value) || 0;
                const payout = (drops * 25) + (kills * 5);
                entry = {
                    date: document.getElementById('cl-date').value,
                    name: document.getElementById('cl-name').value,
                    drops: drops,
                    kills: kills,
                    payout: `${payout}k`
                };
                if (!entry.date || !entry.name) return alert('Bitte alle Felder ausfÃ¼llen!');
            }
            else if (type === 'ammu') {
                const count = parseInt(document.getElementById('am-count').value) || 0;
                const payout = count * 10;
                entry = {
                    date: document.getElementById('am-date').value,
                    name: document.getElementById('am-name').value,
                    count: count,
                    payout: `${payout}k`
                };
                if (!entry.date || !entry.name) return alert('Bitte alle Felder ausfÃ¼llen!');
            }
            else if (type === 'invites') {
                const place = document.getElementById('inv-place').value;
                const rewards = {'1': 'Heavy', '2': '250k', '3': '150k'};
                const invites = parseInt(document.getElementById('inv-count').value) || 0;
                entry = {
                    date: document.getElementById('inv-date').value,
                    name: document.getElementById('inv-name').value,
                    invites: invites,
                    place: `Top ${place}`,
                    reward: rewards[place]
                };
                if (!entry.date || !entry.name || !place) return alert('Bitte alle Felder ausfÃ¼llen!');
            }

            data[type].push(entry);
            await saveData(type);
            updateTable(type);
            updateStats(type);
            clearInputs(type);
        }

        function updateTable(type) {
            const tableId = type === 'fort-zancudo' ? 'fz-table' : 
                           type === 'spray-logs' ? 'sl-table' :
                           type === 'cland' ? 'cl-table' :
                           type === 'ammu' ? 'am-table' : 'inv-table';
            
            const tbody = document.querySelector(`#${tableId} tbody`);
            tbody.innerHTML = '';

            data[type].forEach((entry, index) => {
                const row = tbody.insertRow();
                
                if (type === 'fort-zancudo') {
                    row.innerHTML = `
                        <td>${entry.date}</td>
                        <td>${entry.name}</td>
                        <td>${entry.prize}</td>
                        <td><button class="delete-btn" onclick="deleteEntry('${type}', ${index})">LÃ¶schen</button></td>
                    `;
                } else if (type === 'spray-logs') {
                    row.innerHTML = `
                        <td>${entry.date}</td>
                        <td>${entry.name}</td>
                        <td>${entry.place}</td>
                        <td>${entry.payout}</td>
                        <td><button class="delete-btn" onclick="deleteEntry('${type}', ${index})">LÃ¶schen</button></td>
                    `;
                } else if (type === 'cland') {
                    row.innerHTML = `
                        <td>${entry.date}</td>
                        <td>${entry.name}</td>
                        <td>${entry.drops}</td>
                        <td>${entry.kills}</td>
                        <td>${entry.payout}</td>
                        <td><button class="delete-btn" onclick="deleteEntry('${type}', ${index})">LÃ¶schen</button></td>
                    `;
                } else if (type === 'ammu') {
                    row.innerHTML = `
                        <td>${entry.date}</td>
                        <td>${entry.name}</td>
                        <td>${entry.count}</td>
                        <td>${entry.payout}</td>
                        <td><button class="delete-btn" onclick="deleteEntry('${type}', ${index})">LÃ¶schen</button></td>
                    `;
                } else if (type === 'invites') {
                    row.innerHTML = `
                        <td>${entry.date}</td>
                        <td>${entry.name}</td>
                        <td>${entry.invites}</td>
                        <td>${entry.place}</td>
                        <td>${entry.reward}</td>
                        <td><button class="delete-btn" onclick="deleteEntry('${type}', ${index})">LÃ¶schen</button></td>
                    `;
                }
            });
        }

        function updateStats(type) {
            if (type === 'spray-logs') {
                const total = data[type].reduce((sum, entry) => {
                    return sum + parseInt(entry.payout);
                }, 0);
                document.getElementById('sl-total').textContent = `${total}k`;
            } else if (type === 'cland') {
                const total = data[type].reduce((sum, entry) => {
                    return sum + parseInt(entry.payout);
                }, 0);
                document.getElementById('cl-total').textContent = `${total}k`;
            } else if (type === 'ammu') {
                const total = data[type].reduce((sum, entry) => {
                    return sum + parseInt(entry.payout);
                }, 0);
                document.getElementById('am-total').textContent = `${total}k`;
            }
        }

        async function deleteEntry(type, index) {
            if (confirm('Eintrag wirklich lÃ¶schen?')) {
                data[type].splice(index, 1);
                await saveData(type);
                updateTable(type);
                updateStats(type);
            }
        }

        async function resetData(type) {
            if (confirm('ACHTUNG: Alle Daten fÃ¼r diese Kategorie werden dauerhaft gelÃ¶scht! Fortfahren?')) {
                data[type] = [];
                await saveData(type);
                updateTable(type);
                updateStats(type);
                alert('Alle Daten wurden gelÃ¶scht!');
            }
        }

        function clearInputs(type) {
            const prefix = type === 'fort-zancudo' ? 'fz' :
                          type === 'spray-logs' ? 'sl' :
                          type === 'cland' ? 'cl' :
                          type === 'ammu' ? 'am' : 'inv';
            
            document.querySelectorAll(`[id^="${prefix}-"]`).forEach(input => {
                if (input.type === 'text' || input.type === 'number' || input.type === 'date') {
                    input.value = '';
                } else if (input.tagName === 'SELECT') {
                    input.selectedIndex = 0;
                }
            });
        }

        function exportData(type) {
            if (data[type].length === 0) {
                alert('Keine Daten zum Exportieren!');
                return;
            }

            let csv = '';
            const entries = data[type];

            if (type === 'fort-zancudo') {
                csv = 'Datum,Spielername,Gewinn\n';
                entries.forEach(e => csv += `${e.date},${e.name},${e.prize}\n`);
            } else if (type === 'spray-logs') {
                csv = 'Datum,Spielername,Platzierung,Auszahlung\n';
                entries.forEach(e => csv += `${e.date},${e.name},${e.place},${e.payout}\n`);
            } else if (type === 'cland') {
                csv = 'Datum,Spielername,Drops,Kills,Auszahlung\n';
                entries.forEach(e => csv += `${e.date},${e.name},${e.drops},${e.kills},${e.payout}\n`);
            } else if (type === 'ammu') {
                csv = 'Datum,Spielername,Anfahrten,Auszahlung\n';
                entries.forEach(e => csv += `${e.date},${e.name},${e.count},${e.payout}\n`);
            } else if (type === 'invites') {
                csv = 'Datum,Spielername,Invites,Platzierung,Belohnung\n';
                entries.forEach(e => csv += `${e.date},${e.name},${e.invites},${e.place},${e.reward}\n`);
            }

            const blob = new Blob([csv], { type: 'text/csv' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `${type}_export.csv`;
            a.click();
        }

        // Daten beim Start laden
        loadAllData();
    </script>
</body>
</html>